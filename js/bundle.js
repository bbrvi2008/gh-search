!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){e.exports=n(3)},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(1),n(2);var i,r,a,o=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)};function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}a=function(e,t){var n=null,i=null;return function(){var r=arguments,a=this,o=Date.now();null!=n&&o-n<t&&clearTimeout(i),i=setTimeout((function(){e.apply(a,r)}),t),n=Date.now()}},(r="debounce")in(i=o)?Object.defineProperty(i,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[r]=a;var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"getRepositories",value:function(e){var t=Object.assign({q:"",sort:"stars",order:"desc"},e),n="".concat(this._baseUri,"/search/repositories?").concat(this._parametersToString(t));return fetch(n).then((function(e){return e.json()})).catch((function(e){console.log(e)}))}},{key:"_parametersToString",value:function(e){return Object.entries(e).map((function(e){return e.join("=")})).join("&")}}],(n=null)&&u(t.prototype,n),i&&u(t,i),e}();function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(l,"_baseUri","//api.github.com");var f=function(){function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};s(this,e),d(this,"handleEvent",(function(e){var t=e.target==n.$input,i=e.target.classList.contains("dropdown__list-item");switch(e.type){case"keydown":var r=n.$input.value;n.onChangedValue(r);break;case"click":t&&n.handleInputClick(e.target),i&&n.handleListItemClick(e.target);break;case"change":t&&console.log(n.$input.value)}})),this.$container=t,this.$input=t.querySelector("input"),this.$list=t.querySelector(".dropdown__list"),this.items=[];var r=i.onChangedValue,a=i.onSelectedItem;this.onChangedValue=r||function(){},this.onSelectedItem=a||function(){},this._init()}var t,n,i;return t=e,(n=[{key:"updateItems",value:function(e){this.items=e,this._renderListItems()}},{key:"handleInputClick",value:function(e){}},{key:"handleListItemClick",value:function(e){var t=e.dataset.id,n=this.items.find((function(e){return e.id==t}));this.onSelectedItem(n),this._reset()}},{key:"_init",value:function(){this.$container.addEventListener("keydown",this.handleEvent),this.$container.addEventListener("change",this.handleEvent),this.$container.addEventListener("click",this.handleEvent),this._renderListItems()}},{key:"_reset",value:function(){this.items=[],this.$input.value="",this.$list.textContent="",this.$list.hidden=!0}},{key:"_renderListItems",value:function(){if(0!==this.items.length){var e=this.$list,t=this._buildListItems(this.items);e.textContent="",t.forEach((function(t){e.append(t)})),e.hidden=!1}}},{key:"_buildListItems",value:function(e){return e.map(this._buildListItem)}},{key:"_buildListItem",value:function(e){var t=e.id,n=e.value,i=document.createElement("li");return i.classList.add("dropdown__list-item"),i.dataset.id=t,i.textContent=n,i}}])&&c(t.prototype,n),i&&c(t,i),e}();function b(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function p(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),e}var m=function(){function e(){v(this,e)}return p(e,null,[{key:"buildCell",value:function(e,t){var n=document.createElement("td");return n.classList.add("responsive-table__cell"),t&&(n.dataset.title=t),n.append(e),n}},{key:"buildTextCell",value:function(e,t){var n=document.createElement("span");return n.classList.add("responsive-table__cell-text"),n.textContent=e,this.buildCell(n,t)}},{key:"buildButtonCell",value:function(e){var t=document.createElement("div");t.classList.add("button__icon","button__icon--border","icon",e);var n=document.createElement("button");n.classList.add("button"),n.setAttribute("type","button"),n.append(t);var i=this.buildCell(n);return i.classList.add("responsive-table__button"),i}},{key:"buildRow",value:function(e){var t=document.createElement("tr");return t.classList.add("responsive-table__row"),e.forEach((function(e){t.append(e)})),t}},{key:"buildBody",value:function(e){var t=document.createElement("tbody");return t.classList.add("responsive-table__tbody"),e.forEach((function(e){t.append(e)})),t}},{key:"buildHeaderCell",value:function(e){var t=document.createElement("th");return t.classList.add("responsive-table__header-cell"),t.textContent=e,t}},{key:"buildHeaderRow",value:function(e){var t=document.createElement("tr");return t.classList.add("responsive-table__header"),e.forEach((function(e){t.append(e)})),t}},{key:"buildHeader",value:function(e){var t=document.createElement("thead");return t.classList.add("responsive-table__thead"),t.append(e),t}},{key:"buildTable",value:function(){var e=document.createElement("table");return e.classList.add("responsive-table"),e}}]),e}(),y=function(){function e(t,n){var i=n.columns,r=n.data,a=void 0===r?[]:r,o=b(n,["columns","data"]);v(this,e),this.columns=i;var u=this._buildTable(i,a,o);this.$container=t,this.$container.append(u),this.rebuildTable=this._createRebuildTableFunction(i,o)}return p(e,[{key:"_createRebuildTableFunction",value:function(e,t){var n=this;return function(i){var r=n._buildRows(i,e,t);n.body.textContent="",r.forEach((function(e){n.body.append(e)}))}}},{key:"_buildTable",value:function(e,t,n){this.headerRow=this._buildHeaderRow(e,n);var i=this._buildRows(t,e,n),r=m.buildHeader(this.headerRow);this.body=m.buildBody(i);var a=m.buildTable();return a.append(r),a.append(this.body),a}},{key:"_getCountColumns",value:function(e,t){var n=t.removableRows,i=e.length;return n&&++i,i}},{key:"_buildHeaderRow",value:function(e,t){var n=e.map((function(e){var t=e.title;return m.buildHeaderCell(t)})).concat(this._buildAdditionalHeaderCells(t));return m.buildHeaderRow(n)}},{key:"_buildRows",value:function(e,t,n){var i=this._getCountColumns(t,n);return e&&e.length>0?this._buildDataRows(e,t,n):[this._buildEmptyRow(i)]}},{key:"_buildEmptyRow",value:function(e){var t=m.buildTextCell("Данные отсутствуют");return t.setAttribute("colspan",e),m.buildRow([t])}},{key:"_buildDataRows",value:function(e,t,n){var i=this;return e.map((function(e){return i._buildDataRow(e,t,n)}))}},{key:"_buildDataRow",value:function(e,t,n){var i=t.map((function(t){var n=t.name,i=t.title;return m.buildCell(e[n],i)})).concat(this._buildAdditionalDataCells(e,n));return m.buildRow(i)}},{key:"_buildAdditionalHeaderCells",value:function(e){var t=[];return e.removableRows&&t.push(m.buildHeaderCell("")),t}},{key:"_buildAdditionalDataCells",value:function(e,t){var n=t.removableRows,i=t.onRemovedRow,r=[];if(n){var a=m.buildButtonCell("icon--close");a.addEventListener("click",(function(){i(e)})),r.push(a)}return r}}]),e}();function _(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var g=function e(t,n){w(this,e),this.isOnce=n||!1,this.callback=t},k=function(){function e(){w(this,e),this.events={}}var t,n,i;return t=e,(n=[{key:"on",value:function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(new g(t))}},{key:"off",value:function(e,t){this.events[e]=this.events[e].filter((function(e){return e===t}))}},{key:"once",value:function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(new g(t,!0))}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r=this.events[e];r&&(r.forEach((function(e){e.callback.apply(e,n)})),this.events[e]=r.filter((function(e){return!e.isOnce})))}}])&&_(t.prototype,n),i&&_(t,i),e}();function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function E(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var C="event:search-value-changed",j="event:repository-selected",T="event:repositories-loaded",L="event:removing-repository";new(function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),R(this,"_handleSearchValueChanged",(function(e){l.getRepositories({q:e,per_page:5}).then((function(e){return null==e?[]:e.items.map((function(e){return{id:e.id,name:e.name,full_name:e.full_name,stars:e.stargazers_count,owner:e.owner.login}}))})).then((function(e){t.eventEmitter.emit(T,e)}))})),R(this,"_handleRepositoriesLoaded",(function(e){var n=e.map((function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){R(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({value:e.full_name},e)}));t.searchInput.updateItems(n)})),R(this,"_handleRepositorySelected",(function(e){t.data.push(e),t.repositoriesTable.rebuildTable(t.data)})),R(this,"_handleRemovingRepository",(function(e){t.data=t.data.filter((function(t){return t.id!=e.id})),t.repositoriesTable.rebuildTable(t.data)})),this.data=[],this.eventEmitter=new k;var n=document.querySelector(".dropdown");this.searchInput=this._buildSearchInput(n),this._bindSearchInputHandlers();var i=document.querySelector(".repositories");this.repositoriesTable=this._buildRepositoriesTable(i),this._bindRepositoriesTableHandlers()}var t,n,i;return t=e,(n=[{key:"_buildSearchInput",value:function(e){var t=this;return new f(e,{onChangedValue:function(e){t.eventEmitter.emit(C,e)},onSelectedItem:function(e){t.eventEmitter.emit(j,e)}})}},{key:"_bindSearchInputHandlers",value:function(){this.eventEmitter.on(C,o.debounce(this._handleSearchValueChanged,500)),this.eventEmitter.on(T,this._handleRepositoriesLoaded)}},{key:"_buildRepositoriesTable",value:function(e){var t=this;return new y(e,{columns:[{name:"name",title:"Name"},{name:"owner",title:"Owner"},{name:"stars",title:"Stars"}],data:this.data,removableRows:!0,onRemovedRow:function(e){t.eventEmitter.emit(L,e)}})}},{key:"_bindRepositoriesTableHandlers",value:function(){this.eventEmitter.on(j,this._handleRepositorySelected),this.eventEmitter.on(L,this._handleRemovingRepository)}}])&&E(t.prototype,n),i&&E(t,i),e}())}]);
//# sourceMappingURL=bundle.js.map